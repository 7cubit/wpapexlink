"use strict";(globalThis.webpackChunkwp_apexlink=globalThis.webpackChunkwp_apexlink||[]).push([[407],{96407(e,t,a){a.r(t),a.d(t,{default:()=>y});var r=a(51609),n=a(27723),l=a(86087),s=a(17769),o=a(33930),c=a(57097),i=a(90232),d=a(48635),m=a(48309),g=a(35627),p=a(77079),x=a(98445),u=a(8723),b=a(90888);const y=({darkMode:e})=>{const t=(0,l.useRef)(null),a=(0,l.useRef)(null),[y,f]=(0,l.useState)(null),[h,w]=(0,l.useState)(""),[k,E]=(0,l.useState)("all"),[v,N]=(0,l.useState)(null),_=window.wpApexLinkData?.apiUrl||"/wp-json/apexlink/v1",{data:A,isLoading:j}=(0,o.I)({queryKey:["visual-graph"],queryFn:async()=>(await fetch(`${_}/graph/visual`,{headers:{"X-WP-Nonce":window.wpApexLinkData?.nonce}})).json()}),L=(0,c.n)({mutationFn:async e=>(await fetch(`${_}/graph/connections?post_id=${e}`,{headers:{"X-WP-Nonce":window.wpApexLinkData?.nonce}})).json(),onSuccess:e=>{N(e),b.Ay.success((0,n.__)("Connection analysis complete!","wp-apexlink"))},onError:()=>{b.Ay.error((0,n.__)("Failed to analyze connections.","wp-apexlink"))}});(0,l.useEffect)(()=>{N(null)},[y?.id]),(0,l.useEffect)(()=>{if(!(A&&A.nodes&&t.current&&a.current))return;const r=a.current.clientWidth,n=a.current.clientHeight;s.Ltv(t.current).selectAll("*").remove();const l=s.Ltv(t.current).attr("width",r).attr("height",n).attr("viewBox",[0,0,r,n]),o=l.append("g"),c=s.s_O().scaleExtent([.1,10]).on("zoom",e=>{o.attr("transform",e.transform)});l.call(c);const i=A.nodes.map(e=>({...e})),d=A.links.map(e=>({...e})),m=s.tXi(i).force("link",s.kJC(d).id(e=>e.id).distance(150)).force("charge",s.xJS().strength(-400)).force("center",s.jTM(r/2,n/2)).force("collision",s.eRw().radius(e=>3*Math.sqrt(e.score||1)+15)),g=o.append("g").selectAll("line").data(d).join("line").attr("stroke",e?"#4b5563":"#cbd5e1").attr("stroke-opacity",.4).attr("stroke-width",1.5).attr("class","graph-edge transition-all duration-300"),p=s.UMr(s.zt),x=o.append("g").selectAll("g").data(i).join("g").attr("class","cursor-pointer group").call(s.$Er().on("start",function(e){e.active||m.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y}).on("drag",function(e){e.subject.fx=e.x,e.subject.fy=e.y}).on("end",function(e){e.active||m.alphaTarget(0),e.subject.fx=null,e.subject.fy=null}));return x.append("circle").attr("r",e=>2*Math.sqrt(e.score||1)+8).attr("fill",e=>p(e.category)).attr("stroke",e?"#1f2937":"#fff").attr("stroke-width",3).attr("class","transition-all duration-300 drop-shadow-sm neural-glow").on("mouseover",function(e,t){s.Ltv(this).attr("stroke","#6366f1").attr("stroke-width",5),g.filter(e=>e.source.id===t.id||e.target.id===t.id).attr("stroke","#6366f1").attr("stroke-opacity",1).attr("stroke-width",3)}).on("mouseout",function(){s.Ltv(this).attr("stroke",e?"#1f2937":"#fff").attr("stroke-width",3),g.attr("stroke",e?"#4b5563":"#cbd5e1").attr("stroke-opacity",.4).attr("stroke-width",1.5)}).on("click",(e,t)=>{e.stopPropagation(),f(t)}),x.append("text").attr("dy",".35em").attr("x",e=>2*Math.sqrt(e.score||1)+12).text(e=>e.title).attr("class","text-[10px] font-bold "+(e?"fill-gray-400":"fill-gray-600")).style("display",e=>e.score>40?"block":"none").style("pointer-events","none").style("text-shadow",e?"0 1px 2px rgba(0,0,0,0.8)":"0 1px 2px rgba(255,255,255,0.8)"),m.on("tick",()=>{g.attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y),x.attr("transform",e=>`translate(${e.x},${e.y})`)}),()=>m.stop()},[A,e]);const C=["all",...new Set(A?.nodes?.map(e=>e.category)||[])];return(0,r.createElement)("div",{className:"flex flex-col h-[calc(100vh-120px)] animate-in fade-in duration-500"},(0,r.createElement)("div",{className:"flex flex-wrap items-center justify-between p-4 mb-4 rounded-xl border "+(e?"bg-gray-800 border-gray-700":"bg-white border-gray-100 shadow-sm")},(0,r.createElement)("div",{className:"flex items-center space-x-4"},(0,r.createElement)("div",{className:"relative"},(0,r.createElement)(x.A,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,r.createElement)("input",{type:"text",placeholder:(0,n.__)("Search posts...","wp-apexlink"),className:"pl-10 pr-4 py-2 rounded-lg text-sm border focus:ring-2 focus:ring-neuro-brain outline-none w-64 "+(e?"bg-gray-900 border-gray-700 text-white":"bg-gray-50 border-gray-200"),value:h,onChange:e=>w(e.target.value)})),(0,r.createElement)("div",{className:"flex items-center space-x-2"},(0,r.createElement)(g.A,{className:"w-4 h-4 text-gray-400"}),(0,r.createElement)("select",{className:"py-2 px-3 rounded-lg text-sm border focus:ring-2 focus:ring-neuro-brain outline-none "+(e?"bg-gray-900 border-gray-700 text-white":"bg-gray-50 border-gray-200"),value:k,onChange:e=>E(e.target.value)},C.map(e=>(0,r.createElement)("option",{key:e,value:e},"all"===e?(0,n.__)("All Categories","wp-apexlink"):e))))),(0,r.createElement)("div",{className:"flex items-center space-x-2"},(0,r.createElement)("button",{className:"p-2 rounded-lg border hover:bg-opacity-80 "+(e?"bg-gray-700 border-gray-600 text-gray-300":"bg-gray-50 border-gray-200 text-gray-600")},(0,r.createElement)(m.A,{className:"w-4 h-4"})),(0,r.createElement)("button",{className:"p-2 rounded-lg border hover:bg-opacity-80 "+(e?"bg-gray-700 border-gray-600 text-gray-300":"bg-gray-50 border-gray-200 text-gray-600")},(0,r.createElement)(p.A,{className:"w-4 h-4"})))),(0,r.createElement)("div",{className:"flex-grow flex space-x-4 min-h-0"},(0,r.createElement)("div",{ref:a,className:"flex-grow rounded-2xl border overflow-hidden relative "+(e?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-100")},j?(0,r.createElement)("div",{className:"absolute inset-0 flex flex-col items-center justify-center"},(0,r.createElement)("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mb-4"}),(0,r.createElement)("p",{className:"text-gray-500 font-medium"},(0,n.__)("Generating neural map...","wp-apexlink"))):(0,r.createElement)("svg",{ref:t,className:"w-full h-full cursor-grab active:cursor-grabbing"}),(0,r.createElement)("div",{className:"absolute bottom-4 left-4 p-4 rounded-xl bg-opacity-80 backdrop-blur-md border border-opacity-20 flex flex-col space-y-2 pointer-events-none"},(0,r.createElement)("div",{className:"flex items-center space-x-2"},(0,r.createElement)("span",{className:"w-3 h-3 rounded-full bg-indigo-500"}),(0,r.createElement)("span",{className:"text-xs font-medium "+(e?"text-gray-300":"text-gray-600")},(0,n.__)("Authority Link","wp-apexlink"))),(0,r.createElement)("p",{className:"text-[10px] text-gray-500 italic max-w-xs"},(0,n.__)("Node size represents PageRank authority. Link density shows your content silos.","wp-apexlink")))),y&&(0,r.createElement)("div",{className:"w-80 rounded-2xl border p-6 overflow-y-auto animate-in slide-in-from-right duration-300 "+(e?"bg-gray-800 border-gray-700 shadow-xl":"bg-white border-gray-100 shadow-sm")},(0,r.createElement)("div",{className:"flex items-center justify-between mb-6"},(0,r.createElement)("h3",{className:"font-bold text-lg "+(e?"text-white":"text-gray-900")},(0,n.__)("Page Details","wp-apexlink")),(0,r.createElement)("button",{onClick:()=>f(null),className:"text-gray-400 hover:text-gray-600"},"Ã—")),(0,r.createElement)("div",{className:"space-y-6"},(0,r.createElement)("div",null,(0,r.createElement)("label",{className:"text-xs font-bold uppercase tracking-wider text-gray-400 mb-2 block"},(0,n.__)("Title","wp-apexlink")),(0,r.createElement)("p",{className:"font-semibold leading-relaxed "+(e?"text-gray-100":"text-gray-800")},y.title)),(0,r.createElement)("div",{className:"grid grid-cols-2 gap-4"},(0,r.createElement)("div",null,(0,r.createElement)("label",{className:"text-xs font-bold uppercase tracking-wider text-gray-400 mb-1 block"},(0,n.__)("Authority","wp-apexlink")),(0,r.createElement)("div",{className:"text-2xl font-black "+(y.score>70?"text-green-500":y.score>40?"text-blue-500":"text-gray-400")},Math.round(y.score))),(0,r.createElement)("div",null,(0,r.createElement)("label",{className:"text-xs font-bold uppercase tracking-wider text-gray-400 mb-1 block"},(0,n.__)("Category","wp-apexlink")),(0,r.createElement)("span",{className:"inline-block px-2 py-1 rounded-md text-[10px] font-bold "+(e?"bg-indigo-900/30 text-indigo-400":"bg-indigo-50 text-indigo-600")},y.category))),(0,r.createElement)("div",{className:"pt-6 border-t border-opacity-10"},(0,r.createElement)("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",className:"block w-full text-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-3 rounded-xl transition-all mb-3 text-sm"},(0,n.__)("View Post","wp-apexlink")),(0,r.createElement)("button",{onClick:()=>{y&&(N(null),L.mutate(y.id))},disabled:L.isPending,className:"w-full bg-neuro-brain hover:bg-opacity-90 text-white font-bold py-3 rounded-xl transition-all text-sm flex items-center justify-center gap-2"},L.isPending?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(u.A,{className:"w-4 h-4 animate-spin"}),(0,n.__)("Analyzing...","wp-apexlink")):(0,n.__)("Analyze Connections","wp-apexlink"))),v&&(0,r.createElement)("div",{className:"pt-6 border-t border-opacity-10 space-y-4 animate-in fade-in duration-300"},(0,r.createElement)("div",null,(0,r.createElement)("div",{className:"flex items-center gap-2 mb-3"},(0,r.createElement)(d.A,{className:"w-4 h-4 text-emerald-500"}),(0,r.createElement)("label",{className:"text-xs font-bold uppercase tracking-wider text-gray-400"},(0,n.__)("Outbound Links","wp-apexlink")," (",v.outbound?.length||0,")")),(0,r.createElement)("div",{className:"space-y-2 max-h-40 overflow-y-auto"},v.outbound?.length>0?v.outbound.map((t,a)=>(0,r.createElement)("a",{key:a,href:t.url,target:"_blank",rel:"noopener noreferrer",className:"block p-2 rounded-lg text-xs truncate transition-all "+(e?"bg-gray-700 hover:bg-gray-600 text-gray-300":"bg-gray-50 hover:bg-gray-100 text-gray-600")},(0,r.createElement)("span",{className:"font-medium"},t.title||t.anchor))):(0,r.createElement)("p",{className:"text-xs text-gray-500 italic"},(0,n.__)("No outbound links","wp-apexlink")))),(0,r.createElement)("div",null,(0,r.createElement)("div",{className:"flex items-center gap-2 mb-3"},(0,r.createElement)(i.A,{className:"w-4 h-4 text-indigo-500"}),(0,r.createElement)("label",{className:"text-xs font-bold uppercase tracking-wider text-gray-400"},(0,n.__)("Inbound Links","wp-apexlink")," (",v.inbound?.length||0,")")),(0,r.createElement)("div",{className:"space-y-2 max-h-40 overflow-y-auto"},v.inbound?.length>0?v.inbound.map((t,a)=>(0,r.createElement)("a",{key:a,href:t.url,target:"_blank",rel:"noopener noreferrer",className:"block p-2 rounded-lg text-xs truncate transition-all "+(e?"bg-gray-700 hover:bg-gray-600 text-gray-300":"bg-gray-50 hover:bg-gray-100 text-gray-600")},(0,r.createElement)("span",{className:"font-medium"},t.title||t.anchor))):(0,r.createElement)("p",{className:"text-xs text-gray-500 italic"},(0,n.__)("No inbound links","wp-apexlink")))),(0,r.createElement)("div",{className:"p-4 rounded-xl "+(e?"bg-indigo-900/20":"bg-indigo-50")},(0,r.createElement)("div",{className:"grid grid-cols-2 gap-4 text-center"},(0,r.createElement)("div",null,(0,r.createElement)("div",{className:"text-xl font-black text-emerald-500"},v.outbound?.length||0),(0,r.createElement)("div",{className:"text-[10px] text-gray-500 uppercase font-bold"},(0,n.__)("Links Out","wp-apexlink"))),(0,r.createElement)("div",null,(0,r.createElement)("div",{className:"text-xl font-black text-indigo-500"},v.inbound?.length||0),(0,r.createElement)("div",{className:"text-[10px] text-gray-500 uppercase font-bold"},(0,n.__)("Links In","wp-apexlink"))))))))))}}}]);